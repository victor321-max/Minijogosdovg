<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Jogo da Velha</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #e3f2fd;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #0d47a1;
      margin-bottom: 10px;
    }
    #modoJogo {
      margin-bottom: 20px;
    }
    select, button {
      padding: 10px;
      font-size: 16px;
      margin: 5px;
      border-radius: 5px;
      border: none;
    }
    button {
      background-color: #1976d2;
      color: white;
      cursor: pointer;
    }
    #tabuleiro {
      display: grid;
      grid-template-columns: repeat(3, 100px);
      gap: 10px;
      justify-content: center;
      margin: 20px auto;
    }
    .casa {
      width: 100px;
      height: 100px;
      font-size: 48px;
      background: #2196f3;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      border-radius: 10px;
      cursor: pointer;
    }
    .casa:hover {
      background: #1565c0;
    }
    #mensagem, #placar {
      font-size: 18px;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<h1>Jogo da Velha</h1>

<div id="modoJogo">
  <label for="seletorModo">Modo de Jogo: </label>
  <select id="seletorModo">
    <option value="2jogadores">2 Jogadores</option>
    <option value="facil">IA Fácil</option>
    <option value="medio">IA Médio</option>
    <option value="dificil">IA Difícil</option>
  </select>
  <button onclick="reiniciar()">Reiniciar</button>
</div>

<div id="tabuleiro"></div>

<div id="mensagem"></div>
<div id="placar">Placar - X: 0 | O: 0</div>

<script>
  const tabuleiro = document.getElementById("tabuleiro");
  const mensagem = document.getElementById("mensagem");
  const seletorModo = document.getElementById("seletorModo");
  const placarDiv = document.getElementById("placar");

  let tab = Array(9).fill("");
  let vez = "X";
  let jogoAtivo = true;
  let placar = { X: 0, O: 0 };

  function criarTabuleiro() {
    tabuleiro.innerHTML = "";
    tab.forEach((_, i) => {
      const div = document.createElement("div");
      div.classList.add("casa");
      div.dataset.index = i;
      div.addEventListener("click", () => jogar(i));
      tabuleiro.appendChild(div);
    });
    atualizarMensagem();
  }

  function jogar(i) {
    if (!jogoAtivo || tab[i]) return;
    tab[i] = vez;
    atualizarTabuleiro();
    if (vitoria(vez)) {
      placar[vez]++;
      placarDiv.textContent = `Placar - X: ${placar.X} | O: ${placar.O}`;
      mensagem.textContent = `Jogador ${vez} venceu!`;
      jogoAtivo = false;
      return;
    }
    if (!tab.includes("")) {
      mensagem.textContent = "Empate!";
      jogoAtivo = false;
      return;
    }
    vez = vez === "X" ? "O" : "X";
    atualizarMensagem();
    if (vez === "O" && seletorModo.value !== "2jogadores") {
      setTimeout(jogadaIA, 400);
    }
  }

  function atualizarTabuleiro() {
    document.querySelectorAll(".casa").forEach((el, i) => {
      el.textContent = tab[i];
    });
  }

  function atualizarMensagem() {
    mensagem.textContent = `Vez do jogador ${vez}`;
  }

  function vitoria(jogador) {
    const v = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];
    return v.some(comb => comb.every(i => tab[i] === jogador));
  }

  function jogadaIA() {
    const modo = seletorModo.value;
    let i;
    if (modo === "facil") {
      const vagas = tab.map((v, i) => v === "" ? i : null).filter(v => v !== null);
      i = vagas[Math.floor(Math.random() * vagas.length)];
    } else if (modo === "medio") {
      i = estrategiaMedia();
    } else {
      i = minimax(tab, "O").index;
    }
    jogar(i);
  }

  function estrategiaMedia() {
    for (let i = 0; i < 9; i++) {
      if (tab[i] === "") {
        tab[i] = "O";
        if (vitoria("O")) {
          tab[i] = "";
          return i;
        }
        tab[i] = "";
      }
    }
    for (let i = 0; i < 9; i++) {
      if (tab[i] === "") {
        tab[i] = "X";
        if (vitoria("X")) {
          tab[i] = "";
          return i;
        }
        tab[i] = "";
      }
    }
    return tab.findIndex(v => v === "");
  }

  function minimax(novoTab, jogador) {
    const oposto = jogador === "X" ? "O" : "X";
    if (vitoria("X")) return { score: -10 };
    if (vitoria("O")) return { score: 10 };
    if (!novoTab.includes("")) return { score: 0 };

    let jogadas = [];

    for (let i = 0; i < 9; i++) {
      if (novoTab[i] === "") {
        let jogada = {};
        jogada.index = i;
        novoTab[i] = jogador;

        let resultado = minimax(novoTab, oposto);
        jogada.score = resultado.score;

        novoTab[i] = "";
        jogadas.push(jogada);
      }
    }

    let melhorJogada;
    if (jogador === "O") {
      let melhorScore = -Infinity;
      jogadas.forEach(j => {
        if (j.score > melhorScore) {
          melhorScore = j.score;
          melhorJogada = j;
        }
      });
    } else {
      let melhorScore = Infinity;
      jogadas.forEach(j => {
        if (j.score < melhorScore) {
          melhorScore = j.score;
          melhorJogada = j;
        }
      });
    }

    return melhorJogada;
  }

  function reiniciar() {
    tab = Array(9).fill("");
    vez = "X";
    jogoAtivo = true;
    criarTabuleiro();
    atualizarMensagem();
  }

  seletorModo.addEventListener("change", reiniciar);
  criarTabuleiro();
</script>
</body>
</html>
